{% extends "base.html" %}
{% load static %}

{% block styles %}
    <script>
        function delete_this(){
            fetch("/posts/delete/",{
	            method: "DELETE",
                headers:{'X-CSRFToken':'{{ csrf_token }}','postid':'{{ post.id }}'},
            }
            ).then((response) => {
        if (response.status === 200) {
            alert('post successfully deleted');
            window.location.replace("/");
        }else{
            alert('hmm, something went wrong');
        }
    });
        }
    </script>
{% endblock %}

{% block content %}
<div>
    <h4 class='fullname'>{{post.author.first_name}} {{post.author.last_name}}</h4>
    <p class='username'>@{{post.author.username}}</p>

</div>
    <h1>{{ post.title }}</h1>
    <p>{{ post.comment }}</p>
    <p>{{ post.content }}</p>
    {% if user.username == post.author.username %}
        <a href="javascript:delete_this()">delete</a>
    {% endif %}



    {% for comments in post_comments %}
        {% include "comment.html"%}
    {% endfor %}

<br>
    <div border-style="solid";>

        <form method="post" action="/newComment/" enctype="multipart/form-data">{% csrf_token %}
            <input name="post" type="hidden" value={{ post.id }}>
            <input name="comment" type="text">
            <input type="submit">

        </form>
    </div>
{% endblock%}